{% assign current_variant = product.selected_or_first_available_variant %}
{%
assign featured_image = current_variant.featured_image | default:
product.featured_image %}

<img src="{{ featured_image | img_url: 'large' }}" alt="{{ featured_image.alt | escape }}" id="ProductPhotoImg"/>
{% for image in product.images %}
    <a href="{{ image.src | img_url: 'large' }}">
        <img src="{{ image.src | img_url: 'compact' }}" alt="{{ image.alt | escape }}"/>
    </a>
{% endfor %}
<h1>{{ product.title }}</h1>
<form action="/cart/add" enctype="multipart/form-data" id="AddToCartForm" method="post">
    <select id="productSelect" name="id">
        {% for variant in product.variants %}
            {% if variant.available %}
                <option value="{{ variant.id }}">
                    {{ variant.title }}
                    -
                    {{ variant.price | money_with_currency }}
                </option>
            {% else %}
                <option disabled="disabled">{{ variant.title }}
                    - sold out</option>
            {% endif %}
        {% endfor %}
    </select>
    {{ current_variant.price | money }}
    <label for="Quantity">quantity</label>
    <input id="Quantity" min="1" name="quantity" type="number" value="1"/>
    <button id="AddToCart" name="add" type="submit">Add to cart</button>
</form>
<div>
    {{ product.description }}
</div>

<div class="modal hidden">
    <button class="btn-close-modal" id="target" onclick="closeModal()">
        &times;
    </button>
    <h2 class="product-single__title" itemprop="name">
        {{ product.title }}
    </h2>
    {% assign current_variant = product.selected_or_first_available_variant %}

    <p>
        current stock :
        <span class="variant-sku">{{ current_variant.sku }}</span>
    </p>

    <h3>Current items in cart:</h3>

    <ul>
        {% for item in cart.items %}
            <li>{{ item.title }}
                : quantity :
                {{ item.quantity }}</li>

        {% endfor %}
    </ul>

    <h4>
        Total :
        {{ cart.item_count }}
        {{ cart.item_count | pluralize: 'Item', 'Items' }}
        (
        {{ cart.total_price | money }}
        )
    </h4>
</div>
<div class="overlay hidden"></div>

<script>

    const modal = document.querySelector(".modal");
    const overlay = document.querySelector(".overlay");
    const btnCloseModal = document.querySelector(".btn-close-modal");

    btnCloseModal.addEventListener("click", function () {
        modal.classList.add("hidden");
        overlay.classList.add("hidden");
    });

    window.addEventListener("load", function () {
        modal.classList.remove("hidden");
        overlay.classList.remove("hidden");
    });
</script>